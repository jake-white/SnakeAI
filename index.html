<html>
<button type = "button" id = "b" onclick = "go();">Go!</button>
<canvas id = "c" width = "500" height = "500"></canvas>
<script>
var canvas = document.getElementById("c");
var interval;
var ctx = canvas.getContext("2d");
var x = 0, y = 0, direction = 2;
var length = 5, columns = 50, rows = 50;
var columnSize = (canvas.width/columns);
var rowSize = (canvas.height/rows);
var snakeX = [];
var snakeY = [];
var foodX, foodY;
var grid;
var go = function() {
	generatePoint();
	for(var i = 0; i < length; ++i)
	{
		snakeX[i] = 10 - i;
		snakeY[i] = 10;
	}
    clearInterval(interval);
    interval = setInterval(tick, 20);
	ctx.clearRect(0, 0, canvas.width, canvas.height);
	for(var c = 0; c < columns; ++c)
	{
		ctx.beginPath();
		ctx.moveTo(columnSize*c, 0);
		ctx.lineTo(columnSize*c, canvas.height);
		ctx.moveTo(0,rowSize*c);
		ctx.lineTo(canvas.width, rowSize*c);
		ctx.stroke();
		grid = ctx.getImageData(0,0,canvas.width, canvas.height);
	}	
	ctx.clearRect(0, 0, canvas.width, canvas.height);
}
var generatePoint = function() {
	foodX = Math.floor(Math.random() * columns - 1);
	foodY = Math.floor(Math.random() * rows - 1);
}

var getDecision = function()
{
	var d = 0;
	if(snakeX[0] > 25)
	d =1;
	return d;
}
var tick = function() 
{
	var decision = getDecision(); //all AI behavior should be here
	if(decision == -1)
		direction--; //left
	else if(decision == 1)
		direction++; //right
	if(direction > 4)
		direction -= 4;
	else if(direction < 1)
		direction += 4;
	if(direction == 1)
	{
		x = 0;
		y = -1;
	}
	else if(direction == 2)
	{
		x = 1;
		y = 0;
	}
	else if(direction == 3)
	{
		x = 0;
		y = 1;
	}
	else if(direction == 4)
	{
		x = -1;
		y = 0;
	}
	ctx.clearRect(0, 0, canvas.width, canvas.height);
	ctx.putImageData(grid, 0, 0);
	for(var i = length-1; i > 0; --i)
	{
		snakeX[i] = snakeX[i -1];
		snakeY[i] = snakeY[i -1];
	}
	snakeX[0] = snakeX[1] + x;
	snakeY[0] = snakeY[1] + y;
	for(var i = 0; i < length; ++i)
	{
		ctx.fillStyle = "red";
		ctx.fillRect(snakeX[i]*columnSize,snakeY[i]*rowSize, columnSize, rowSize);
	}
	ctx.fillRect(foodX * columnSize, foodY * rowSize, columnSize, rowSize);
	if(snakeX[0] > 49 || snakeX[0] < 0 || snakeY[0] > 49 || snakeY[0] < 0)
		clearInterval(interval);
	for(var i = 1; i < length; ++i)
	{
	if(snakeX[0] == snakeX[i] && snakeY[0] == snakeY[i])
		clearInterval(interval);
	}
}
</script>
</html>